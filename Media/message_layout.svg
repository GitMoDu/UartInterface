<?xml version="1.0" encoding="UTF-8"?>
<svg width="920" height="280" viewBox="0 0 920 280" xmlns="http://www.w3.org/2000/svg" role="img">
  <title>Message layout and on-wire framing</title>
  <desc>Pre-COBS layout with CRC0, CRC1, Header, Payload; On-wire framing with 0x00 delimiter and COBS single-block encoding showing overhead and internal message.</desc>
  <defs>
    <style><![CDATA[
      .b { fill:#ffffff; stroke:#2f3b52; stroke-width:2; }
      .crc { fill:#f2f2f2; }
      .hdr { fill:#fff7d6; }
      .pay { fill:#e6f5ff; }
      .delim { fill:#ffe7d6; stroke:#d97a00; }
      .enc { fill:#e8ffe8; stroke:#3a9d23; }
      .enc-ohd { fill:#d8ffd8; stroke:#3a9d23; }
      .lab { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, sans-serif; font-size:13px; fill:#111; }
      .note { font-size:12px; fill:#555; }
      .title { font-weight:600; font-size:14px; fill:#111; }
    ]]></style>
  </defs>

  <!-- Pre-COBS -->
  <text x="20" y="28" class="title">Pre-COBS message bytes (indexes in buffer)</text>

  <g transform="translate(20,60)">
    <rect x="0" y="0" width="100" height="50" class="b crc"/>
    <text x="50" y="22" text-anchor="middle" class="lab">CRC0</text>
    <text x="50" y="38" text-anchor="middle" class="note">index 0</text>

    <rect x="110" y="0" width="100" height="50" class="b crc"/>
    <text x="160" y="22" text-anchor="middle" class="lab">CRC1</text>
    <text x="160" y="38" text-anchor="middle" class="note">index 1</text>

    <rect x="220" y="0" width="120" height="50" class="b hdr"/>
    <text x="280" y="22" text-anchor="middle" class="lab">Header</text>
    <text x="280" y="38" text-anchor="middle" class="note">index 2</text>

    <rect x="350" y="0" width="420" height="50" class="b pay"/>
    <text x="560" y="22" text-anchor="middle" class="lab">Payload (0..N bytes)</text>
    <text x="560" y="38" text-anchor="middle" class="note">index 3..N</text>
  </g>

  <!-- On-wire -->
  <text x="20" y="140" class="title">On-wire framing (UART)</text>

  <g transform="translate(20,152)">
    <rect x="0" y="0" width="120" height="50" class="b delim"/>
    <text x="60" y="22" text-anchor="middle" class="lab">0x00</text>
    <text x="60" y="38" text-anchor="middle" class="note">Delimiter</text>

    <!-- COBS single-block: overhead + internal message -->
    <rect x="130" y="0" width="70" height="50" class="b enc-ohd"/>
    <text x="165" y="22" text-anchor="middle" class="lab">COBS</text>
    <text x="165" y="38" text-anchor="middle" class="note">Overhead</text>

    <rect x="200" y="0" width="480" height="50" class="b enc"/>
    <text x="440" y="22" text-anchor="middle" class="lab">COBS</text>
    <text x="440" y="38" text-anchor="middle" class="note">Encoded</text>

    <rect x="690" y="0" width="120" height="50" class="b delim"/>
    <text x="750" y="22" text-anchor="middle" class="lab">0x00</text>
    <text x="750" y="38" text-anchor="middle" class="note">Delimiter</text>
  </g>
</svg>